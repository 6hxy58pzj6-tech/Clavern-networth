<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>House Empire Command | Property Growth Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary-dark: #0f172a;
            --secondary-dark: #1e293b;
            --accent-green: #10b981;
            --accent-blue: #3b82f6;
            --accent-amber: #f59e0b;
            --accent-purple: #8b5cf6;
        }
        
        .property-card {
            background: linear-gradient(145deg, #1e293b 0%, #0f172a 100%);
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }
        
        .property-card:hover {
            transform: translateY(-2px);
            border-color: var(--accent-green);
            box-shadow: 0 10px 25px rgba(16, 185, 129, 0.1);
        }
        
        .progress-ring {
            width: 100px;
            height: 100px;
        }
        
        .room-card {
            border-left: 4px solid;
            transition: all 0.3s ease;
        }
        
        .room-card:hover {
            transform: translateX(4px);
        }
        
        .room-occupied { border-left-color: #10b981; }
        .room-vacant { border-left-color: #ef4444; }
        .room-renovating { border-left-color: #f59e0b; }
        .room-premium { border-left-color: #8b5cf6; }
        
        .timeline-marker {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            position: absolute;
            left: -6px;
            top: 0;
        }
        
        .metric-glow {
            box-shadow: 0 0 20px rgba(16, 185, 129, 0.3);
        }
        
        .renovation-phase {
            padding: 1rem;
            border-radius: 12px;
            margin-bottom: 1rem;
            border-left: 4px solid;
        }
        
        .phase-1 { border-left-color: #3b82f6; background: rgba(59, 130, 246, 0.1); }
        .phase-2 { border-left-color: #8b5cf6; background: rgba(139, 92, 246, 0.1); }
        .phase-3 { border-left-color: #f59e0b; background: rgba(245, 158, 11, 0.1); }
        .phase-4 { border-left-color: #10b981; background: rgba(16, 185, 129, 0.1); }
    </style>
</head>
<body class="bg-gray-900 text-gray-100 min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <!-- Header -->
        <div class="flex justify-between items-center mb-8">
            <div>
                <h1 class="text-3xl font-bold bg-gradient-to-r from-green-400 to-blue-400 bg-clip-text text-transparent">
                    üè† House Empire Command
                </h1>
                <p class="text-gray-400">Property Growth Dashboard ‚Ä¢ Last updated: <span id="currentDate">Today</span></p>
            </div>
            <div class="flex space-x-4">
                <button onclick="exportData()" class="px-4 py-2 bg-gray-800 rounded-lg hover:bg-gray-700">
                    <i class="fas fa-download mr-2"></i>Export
                </button>
                <button onclick="addRenovation()" class="px-4 py-2 bg-gradient-to-r from-green-500 to-blue-500 rounded-lg font-bold">
                    <i class="fas fa-plus mr-2"></i>Add Project
                </button>
            </div>
        </div>

        <!-- Top Metrics -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
            <div class="property-card p-6">
                <div class="flex justify-between items-start">
                    <div>
                        <div class="text-gray-400 text-sm">Monthly Cashflow</div>
                        <div class="text-2xl font-bold mt-2" id="monthlyCashflow">$--</div>
                        <div class="text-sm text-green-400 mt-1" id="cashflowChange">+0% vs last month</div>
                    </div>
                    <div class="text-2xl text-green-400">
                        <i class="fas fa-chart-line"></i>
                    </div>
                </div>
            </div>
            
            <div class="property-card p-6">
                <div class="flex justify-between items-start">
                    <div>
                        <div class="text-gray-400 text-sm">Property Value</div>
                        <div class="text-2xl font-bold mt-2" id="propertyValue">$--</div>
                        <div class="text-sm text-blue-400 mt-1" id="valueChange">+0% post-renovation</div>
                    </div>
                    <div class="text-2xl text-blue-400">
                        <i class="fas fa-home"></i>
                    </div>
                </div>
            </div>
            
            <div class="property-card p-6">
                <div class="flex justify-between items-start">
                    <div>
                        <div class="text-gray-400 text-sm">Renovation Fund</div>
                        <div class="text-2xl font-bold mt-2" id="renovationFund">$--</div>
                        <div class="text-sm text-amber-400 mt-1" id="fundProgress">0% of target</div>
                    </div>
                    <div class="text-2xl text-amber-400">
                        <i class="fas fa-tools"></i>
                    </div>
                </div>
            </div>
            
            <div class="property-card p-6">
                <div class="flex justify-between items-start">
                    <div>
                        <div class="text-gray-400 text-sm">Occupancy Rate</div>
                        <div class="text-2xl font-bold mt-2" id="occupancyRate">--%</div>
                        <div class="text-sm text-purple-400 mt-1" id="occupancyTarget">Target: 95%</div>
                    </div>
                    <div class="relative progress-ring">
                        <canvas id="occupancyChart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Dashboard Grid -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8">
            <!-- Left Column: Rooms & Income -->
            <div class="lg:col-span-2">
                <!-- Rooms Management -->
                <div class="property-card p-6 mb-6">
                    <h2 class="text-xl font-bold mb-4 flex items-center">
                        <i class="fas fa-door-closed mr-3 text-blue-400"></i>
                        Room Portfolio
                    </h2>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6" id="roomsContainer">
                        <!-- Rooms will be dynamically added here -->
                    </div>
                    
                    <div class="flex justify-between items-center">
                        <div>
                            <div class="text-sm text-gray-400">Total Monthly Rent</div>
                            <div class="text-2xl font-bold" id="totalRent">$--</div>
                        </div>
                        <button onclick="addRoom()" class="px-4 py-2 bg-gray-800 rounded-lg hover:bg-gray-700">
                            <i class="fas fa-plus mr-2"></i>Add Room
                        </button>
                    </div>
                </div>

                <!-- Renovation Timeline -->
                <div class="property-card p-6">
                    <h2 class="text-xl font-bold mb-4 flex items-center">
                        <i class="fas fa-calendar-alt mr-3 text-green-400"></i>
                        12-Month Renovation Timeline
                    </h2>
                    
                    <div class="space-y-4">
                        <div class="renovation-phase phase-1">
                            <div class="flex justify-between items-center">
                                <div>
                                    <div class="font-bold">Months 1-3: Cashflow Optimization</div>
                                    <div class="text-sm text-gray-400">Fund renovations through rent increases</div>
                                </div>
                                <div class="flex items-center">
                                    <span class="px-3 py-1 bg-blue-500 rounded-full text-xs mr-2" id="phase1Progress">0/3</span>
                                    <button onclick="togglePhase(1)" class="text-blue-400">
                                        <i class="fas fa-chevron-down"></i>
                                    </button>
                                </div>
                            </div>
                            <div id="phase1Details" class="mt-3 hidden">
                                <ul class="space-y-2 text-sm">
                                    <li><input type="checkbox" class="mr-2"> Audit all rents vs market rates</li>
                                    <li><input type="checkbox" class="mr-2"> Implement 10% rent increase</li>
                                    <li><input type="checkbox" class="mr-2"> Install prepaid utility meters</li>
                                    <li><input type="checkbox" class="mr-2"> Professional deep clean</li>
                                    <li><input type="checkbox" class="mr-2"> Update property photos</li>
                                </ul>
                            </div>
                        </div>
                        
                        <div class="renovation-phase phase-2">
                            <div class="flex justify-between items-center">
                                <div>
                                    <div class="font-bold">Months 4-6: Value Jump Phase</div>
                                    <div class="text-sm text-gray-400">Strategic renovations for 25-40% value increase</div>
                                </div>
                                <div class="flex items-center">
                                    <span class="px-3 py-1 bg-purple-500 rounded-full text-xs mr-2" id="phase2Progress">0/3</span>
                                    <button onclick="togglePhase(2)" class="text-purple-400">
                                        <i class="fas fa-chevron-down"></i>
                                    </button>
                                </div>
                            </div>
                            <div id="phase2Details" class="mt-3 hidden">
                                <ul class="space-y-2 text-sm">
                                    <li><input type="checkbox" class="mr-2"> Kitchen refresh (vinyl, handles, faucet)</li>
                                    <li><input type="checkbox" class="mr-2"> Bathroom upgrades</li>
                                    <li><input type="checkbox" class="mr-2"> Convert room to ensuite</li>
                                    <li><input type="checkbox" class="mr-2"> Exterior curb appeal</li>
                                    <li><input type="checkbox" class="mr-2"> Flooring in high-traffic areas</li>
                                </ul>
                            </div>
                        </div>
                        
                        <div class="renovation-phase phase-3">
                            <div class="flex justify-between items-center">
                                <div>
                                    <div class="font-bold">Months 7-9: Monetization Phase</div>
                                    <div class="text-sm text-gray-400">Premium rooms & value-added services</div>
                                </div>
                                <div class="flex items-center">
                                    <span class="px-3 py-1 bg-amber-500 rounded-full text-xs mr-2" id="phase3Progress">0/3</span>
                                    <button onclick="togglePhase(3)" class="text-amber-400">
                                        <i class="fas fa-chevron-down"></i>
                                    </button>
                                </div>
                            </div>
                            <div id="phase3Details" class="mt-3 hidden">
                                <ul class="space-y-2 text-sm">
                                    <li><input type="checkbox" class="mr-2"> Create 2 premium rooms (+30% rent)</li>
                                    <li><input type="checkbox" class="mr-2"> Add WiFi package service</li>
                                    <li><input type="checkbox" class="mr-2"> Implement cleaning service option</li>
                                    <li><input type="checkbox" class="mr-2"> Add security system</li>
                                    <li><input type="checkbox" class="mr-2"> Premium room virtual tours</li>
                                </ul>
                            </div>
                        </div>
                        
                        <div class="renovation-phase phase-4">
                            <div class="flex justify-between items-center">
                                <div>
                                    <div class="font-bold">Months 10-12: Scale Phase</div>
                                    <div class="text-sm text-gray-400">Refinance & expansion planning</div>
                                </div>
                                <div class="flex items-center">
                                    <span class="px-3 py-1 bg-green-500 rounded-full text-xs mr-2" id="phase4Progress">0/3</span>
                                    <button onclick="togglePhase(4)" class="text-green-400">
                                        <i class="fas fa-chevron-down"></i>
                                    </button>
                                </div>
                            </div>
                            <div id="phase4Details" class="mt-3 hidden">
                                <ul class="space-y-2 text-sm">
                                    <li><input type="checkbox" class="mr-2"> Property valuation assessment</li>
                                    <li><input type="checkbox" class="mr-2"> Refinance paperwork ready</li>
                                    <li><input type="checkbox" class="mr-2"> Next property research</li>
                                    <li><input type="checkbox" class="mr-2"> Create "House Hacking" system</li>
                                    <li><input type="checkbox" class="mr-2"> Investor pitch deck</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Right Column: Analytics & Quick Actions -->
            <div class="space-y-6">
                <!-- ROI Calculator -->
                <div class="property-card p-6">
                    <h2 class="text-xl font-bold mb-4">Renovation ROI Calculator</h2>
                    
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm text-gray-400 mb-2">Project Cost</label>
                            <input type="number" id="projectCost" placeholder="e.g., 1500" 
                                   class="w-full p-3 bg-gray-800 rounded-lg border border-gray-700" 
                                   oninput="calculateROI()">
                        </div>
                        
                        <div>
                            <label class="block text-sm text-gray-400 mb-2">Expected Rent Increase</label>
                            <input type="number" id="rentIncrease" placeholder="e.g., 200" 
                                   class="w-full p-3 bg-gray-800 rounded-lg border border-gray-700"
                                   oninput="calculateROI()">
                        </div>
                        
                        <div>
                            <label class="block text-sm text-gray-400 mb-2">Value Added</label>
                            <input type="number" id="valueAdded" placeholder="e.g., 5000" 
                                   class="w-full p-3 bg-gray-800 rounded-lg border border-gray-700"
                                   oninput="calculateROI()">
                        </div>
                        
                        <div class="p-4 bg-gray-800 rounded-lg">
                            <div class="text-center">
                                <div class="text-3xl font-bold text-green-400" id="roiPercentage">--%</div>
                                <div class="text-sm text-gray-400">Monthly ROI</div>
                            </div>
                            <div class="mt-3 text-sm">
                                <div class="flex justify-between">
                                    <span>Payback Period:</span>
                                    <span id="paybackPeriod">-- months</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Expense Tracker -->
                <div class="property-card p-6">
                    <h2 class="text-xl font-bold mb-4">Monthly Expenses</h2>
                    
                    <div class="space-y-3" id="expensesContainer">
                        <!-- Expenses will be dynamically added -->
                    </div>
                    
                    <div class="mt-4 pt-4 border-t border-gray-800">
                        <div class="flex justify-between">
                            <span class="font-bold">Total Expenses</span>
                            <span class="font-bold text-red-400" id="totalExpenses">$--</span>
                        </div>
                        <div class="flex justify-between text-sm text-gray-400 mt-1">
                            <span>Net Cashflow</span>
                            <span id="netCashflow">$--</span>
                        </div>
                    </div>
                </div>
                
                <!-- Quick Actions -->
                <div class="property-card p-6">
                    <h2 class="text-xl font-bold mb-4">Quick Actions</h2>
                    
                    <div class="space-y-3">
                        <button onclick="increaseRents()" class="w-full p-3 bg-green-900 text-green-400 rounded-lg hover:bg-green-800 text-left">
                            <i class="fas fa-arrow-up mr-2"></i>Increase All Rents 10%
                        </button>
                        
                        <button onclick="addExpense()" class="w-full p-3 bg-blue-900 text-blue-400 rounded-lg hover:bg-blue-800 text-left">
                            <i class="fas fa-receipt mr-2"></i>Add Monthly Expense
                        </button>
                        
                        <button onclick="fundRenovation()" class="w-full p-3 bg-purple-900 text-purple-400 rounded-lg hover:bg-purple-800 text-left">
                            <i class="fas fa-piggy-bank mr-2"></i>Add to Renovation Fund
                        </button>
                        
                        <button onclick="generateReport()" class="w-full p-3 bg-amber-900 text-amber-400 rounded-lg hover:bg-amber-800 text-left">
                            <i class="fas fa-file-alt mr-2"></i>Generate Progress Report
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Bottom: Charts -->
        <div class="property-card p-6">
            <h2 class="text-xl font-bold mb-4">Growth Analytics</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <canvas id="incomeChart"></canvas>
                </div>
                <div>
                    <canvas id="valueChart"></canvas>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Room Modal -->
    <div id="roomModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center p-4 z-50">
        <div class="bg-gray-800 rounded-lg p-6 w-full max-w-md">
            <h3 class="text-xl font-bold mb-4">Add New Room</h3>
            
            <div class="space-y-4">
                <div>
                    <label class="block text-sm text-gray-400 mb-2">Room Name/Number</label>
                    <input type="text" id="roomName" class="w-full p-3 bg-gray-700 rounded-lg">
                </div>
                
                <div>
                    <label class="block text-sm text-gray-400 mb-2">Monthly Rent</label>
                    <input type="number" id="roomRent" class="w-full p-3 bg-gray-700 rounded-lg">
                </div>
                
                <div>
                    <label class="block text-sm text-gray-400 mb-2">Status</label>
                    <select id="roomStatus" class="w-full p-3 bg-gray-700 rounded-lg">
                        <option value="occupied">Occupied</option>
                        <option value="vacant">Vacant</option>
                        <option value="renovating">Renovating</option>
                        <option value="premium">Premium</option>
                    </select>
                </div>
                
                <div>
                    <label class="block text-sm text-gray-400 mb-2">Notes</label>
                    <textarea id="roomNotes" class="w-full p-3 bg-gray-700 rounded-lg" rows="3"></textarea>
                </div>
            </div>
            
            <div class="flex justify-end space-x-3 mt-6">
                <button onclick="closeRoomModal()" class="px-4 py-2 bg-gray-700 rounded-lg">Cancel</button>
                <button onclick="saveRoom()" class="px-4 py-2 bg-green-500 rounded-lg font-bold">Save Room</button>
            </div>
        </div>
    </div>

    <script>
        // Initialize data
        let houseData = {
            monthlyCashflow: 0,
            propertyValue: 0,
            renovationFund: 0,
            renovationTarget: 10000,
            rooms: [],
            expenses: [],
            phases: {1: 0, 2: 0, 3: 0, 4: 0}
        };

        // Load from localStorage or initialize
        function loadData() {
            const saved = localStorage.getItem('houseEmpireData');
            if (saved) {
                houseData = JSON.parse(saved);
            } else {
                // Initialize with sample data
                houseData.rooms = [
                    {id: 1, name: "Room 101", rent: 300, status: "occupied", notes: "Long-term tenant"},
                    {id: 2, name: "Room 102", rent: 350, status: "premium", notes: "Ensuite, renovated"},
                    {id: 3, name: "Room 103", rent: 280, status: "occupied", notes: "Month-to-month"},
                    {id: 4, name: "Room 104", rent: 0, status: "renovating", notes: "Under renovation"},
                    {id: 5, name: "Room 105", rent: 320, status: "vacant", notes: "Available now"},
                    {id: 6, name: "Room 106", rent: 400, status: "premium", notes: "Master bedroom"}
                ];
                
                houseData.expenses = [
                    {name: "Utilities", amount: 200},
                    {name: "Maintenance", amount: 150},
                    {name: "Insurance", amount: 100},
                    {name: "Taxes", amount: 250}
                ];
                
                houseData.monthlyCashflow = 1650;
                houseData.propertyValue = 250000;
                houseData.renovationFund = 1500;
            }
            updateDashboard();
        }

        // Update all dashboard elements
        function updateDashboard() {
            // Calculate totals
            const totalRent = houseData.rooms.reduce((sum, room) => sum + room.rent, 0);
            const totalExpenses = houseData.expenses.reduce((sum, exp) => sum + exp.amount, 0);
            const occupiedRooms = houseData.rooms.filter(r => r.status === "occupied" || r.status === "premium").length;
            const occupancyRate = Math.round((occupiedRooms / houseData.rooms.length) * 100) || 0;
            const netCashflow = totalRent - totalExpenses;
            
            // Update metrics
            document.getElementById('monthlyCashflow').textContent = `$${netCashflow.toLocaleString()}`;
            document.getElementById('propertyValue').textContent = `$${houseData.propertyValue.toLocaleString()}`;
            document.getElementById('renovationFund').textContent = `$${houseData.renovationFund.toLocaleString()}`;
            document.getElementById('occupancyRate').textContent = `${occupancyRate}%`;
            document.getElementById('totalRent').textContent = `$${totalRent.toLocaleString()}`;
            document.getElementById('totalExpenses').textContent = `$${totalExpenses.toLocaleString()}`;
            document.getElementById('netCashflow').textContent = `$${netCashflow.toLocaleString()}`;
            
            // Fund progress
            const fundProgress = Math.min(Math.round((houseData.renovationFund / houseData.renovationTarget) * 100), 100);
            document.getElementById('fundProgress').textContent = `${fundProgress}% of target`;
            
            // Update date
            document.getElementById('currentDate').textContent = new Date().toLocaleDateString();
            
            // Update rooms display
            updateRoomsDisplay();
            
            // Update expenses display
            updateExpensesDisplay();
            
            // Update charts
            updateCharts();
            
            // Update phase progress
            updatePhaseProgress();
            
            // Save to localStorage
            localStorage.setItem('houseEmpireData', JSON.stringify(houseData));
        }

        // Update rooms display
        function updateRoomsDisplay() {
            const container = document.getElementById('roomsContainer');
            container.innerHTML = '';
            
            houseData.rooms.forEach(room => {
                const statusColors = {
                    occupied: 'bg-green-900 text-green-400',
                    vacant: 'bg-red-900 text-red-400',
                    renovating: 'bg-amber-900 text-amber-400',
                    premium: 'bg-purple-900 text-purple-400'
                };
                
                const roomCard = document.createElement('div');
                roomCard.className = `room-card room-${room.status} p-4 bg-gray-800 rounded-lg`;
                roomCard.innerHTML = `
                    <div class="flex justify-between items-start">
                        <div>
                            <div class="font-bold">${room.name}</div>
                            <div class="text-2xl font-bold mt-2">$${room.rent}</div>
                            <div class="text-sm text-gray-400">${room.notes}</div>
                        </div>
                        <div class="flex flex-col items-end">
                            <span class="px-3 py-1 rounded-full text-xs mb-2 ${statusColors[room.status]}">
                                ${room.status.charAt(0).toUpperCase() + room.status.slice(1)}
                            </span>
                            <div class="flex space-x-2">
                                <button onclick="editRoom(${room.id})" class="text-blue-400">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button onclick="deleteRoom(${room.id})" class="text-red-400">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                `;
                container.appendChild(roomCard);
            });
        }

        // Update expenses display
        function updateExpensesDisplay() {
            const container = document.getElementById('expensesContainer');
            container.innerHTML = '';
            
            houseData.expenses.forEach((expense, index) => {
                const div = document.createElement('div');
                div.className = 'flex justify-between items-center';
                div.innerHTML = `
                    <div>
                        <div class="font-medium">${expense.name}</div>
                    </div>
                    <div class="flex items-center">
                        <span class="text-red-400 mr-4">$${expense.amount}</span>
                        <button onclick="deleteExpense(${index})" class="text-gray-400 hover:text-red-400">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                `;
                container.appendChild(div);
            });
        }

        // Update charts
        function updateCharts() {
            // Occupancy chart
            const occupied = houseData.rooms.filter(r => r.status === "occupied" || r.status === "premium").length;
            const total = houseData.rooms.length;
            const vacancy = total - occupied;
            
            const occupancyCtx = document.getElementById('occupancyChart').getContext('2d');
            new Chart(occupancyCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Occupied', 'Vacant'],
                    datasets: [{
                        data: [occupied, vacancy],
                        backgroundColor: ['#10b981', '#ef4444']
                    }]
                },
                options: {
                    cutout: '70%',
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } }
                }
            });
            
            // Income chart
            const incomeCtx = document.getElementById('incomeChart').getContext('2d');
            new Chart(incomeCtx, {
                type: 'line',
                data: {
                    labels: ['Now', '+3 mo', '+6 mo', '+9 mo', '+12 mo'],
                    datasets: [{
                        label: 'Monthly Income',
                        data: [houseData.rooms.reduce((s, r) => s + r.rent, 0), 2000, 2800, 3500, 4200],
                        borderColor: '#10b981',
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: { display: false }
                    }
                }
            });
            
            // Value chart
            const valueCtx = document.getElementById('valueChart').getContext('2d');
            new Chart(valueCtx, {
                type: 'bar',
                data: {
                    labels: ['Current', 'Phase 1', 'Phase 2', 'Phase 3', 'Phase 4'],
                    datasets: [{
                        label: 'Property Value',
                        data: [houseData.propertyValue, houseData.propertyValue * 1.1, houseData.propertyValue * 1.3, houseData.propertyValue * 1.5, houseData.propertyValue * 1.7],
                        backgroundColor: '#3b82f6'
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: { display: false }
                    }
                }
            });
        }

        // Room management functions
        function addRoom() {
            document.getElementById('roomModal').classList.remove('hidden');
        }

        function closeRoomModal() {
            document.getElementById('roomModal').classList.add('hidden');
            document.getElementById('roomName').value = '';
            document.getElementById('roomRent').value = '';
            document.getElementById('roomStatus').value = 'occupied';
            document.getElementById('roomNotes').value = '';
        }

        function saveRoom() {
            const name = document.getElementById('roomName').value;
            const rent = parseFloat(document.getElementById('roomRent').value) || 0;
            const status = document.getElementById('roomStatus').value;
            const notes = document.getElementById('roomNotes').value;
            
            if (name) {
                houseData.rooms.push({
                    id: Date.now(),
                    name,
                    rent,
                    status,
                    notes
                });
                closeRoomModal();
                updateDashboard();
            }
        }

        function editRoom(id) {
            const room = houseData.rooms.find(r => r.id === id);
            if (room) {
                document.getElementById('roomName').value = room.name;
                document.getElementById('roomRent').value = room.rent;
                document.getElementById('roomStatus').value = room.status;
                document.getElementById('roomNotes').value = room.notes;
                document.getElementById('roomModal').classList.remove('hidden');
                
                // Temporarily store room ID for update
                window.editingRoomId = id;
            }
        }

        function deleteRoom(id) {
            if (confirm('Delete this room?')) {
                houseData.rooms = houseData.rooms.filter(r => r.id !== id);
                updateDashboard();
            }
        }

        // Expense management
        function addExpense() {
            const name = prompt('Expense name:');
            const amount = parseFloat(prompt('Amount:'));
            
            if (name && !isNaN(amount)) {
                houseData.expenses.push({ name, amount });
                updateDashboard();
            }
        }

        function deleteExpense(index) {
            houseData.expenses.splice(index, 1);
            updateDashboard();
        }

        // Phase management
        function togglePhase(phase) {
            const details = document.getElementById(`phase${phase}Details`);
            details.classList.toggle('hidden');
        }

        function updatePhaseProgress() {
            // Update phase completion counts
            const phase1Checks = document.querySelectorAll('#phase1Details input[type="checkbox"]').length;
            const phase2Checks = document.querySelectorAll('#phase2Details input[type="checkbox"]').length;
            const phase3Checks = document.querySelectorAll('#phase3Details input[type="checkbox"]').length;
            const phase4Checks = document.querySelectorAll('#phase4Details input[type="checkbox"]').length;
            
            const completed1 = document.querySelectorAll('#phase1Details input:checked').length;
            const completed2 = document.querySelectorAll('#phase2Details input:checked').length;
            const completed3 = document.querySelectorAll('#phase3Details input:checked').length;
            const completed4 = document.querySelectorAll('#phase4Details input:checked').length;
            
            document.getElementById('phase1Progress').textContent = `${completed1}/${phase1Checks}`;
            document.getElementById('phase2Progress').textContent = `${completed2}/${phase2Checks}`;
            document.getElementById('phase3Progress').textContent = `${completed3}/${phase3Checks}`;
            document.getElementById('phase4Progress').textContent = `${completed4}/${phase4Checks}`;
        }

        // ROI Calculator
        function calculateROI() {
            const cost = parseFloat(document.getElementById('projectCost').value) || 0;
            const rentIncrease = parseFloat(document.getElementById('rentIncrease').value) || 0;
            const valueAdded = parseFloat(document.getElementById('valueAdded').value) || 0;
            
            if (cost > 0 && rentIncrease > 0) {
                const monthlyROI = ((rentIncrease * 12) / cost * 100).toFixed(1);
                const payback = Math.ceil(cost / rentIncrease);
                
                document.getElementById('roiPercentage').textContent = `${monthlyROI}%`;
                document.getElementById('paybackPeriod').textContent = `${payback} months`;
            } else {
                document.getElementById('roiPercentage').textContent = '--%';
                document.getElementById('paybackPeriod').textContent = '-- months';
            }
        }

        // Quick Actions
        function increaseRents() {
            if (confirm('Increase all occupied room rents by 10%?')) {
                houseData.rooms.forEach(room => {
                    if (room.status === 'occupied' || room.status === 'premium') {
                        room.rent = Math.round(room.rent * 1.1);
                    }
                });
                updateDashboard();
                alert('Rents increased!');
            }
        }

        function fundRenovation() {
            const amount = parseFloat(prompt('Amount to add to renovation fund:'));
            if (!isNaN(amount) && amount > 0) {
                houseData.renovationFund += amount;
                updateDashboard();
            }
        }

        function addRenovation() {
            const project = prompt('Renovation project name:');
            const cost = parseFloat(prompt('Estimated cost:'));
            
            if (project && !isNaN(cost)) {
                houseData.renovationFund -= cost;
                if (houseData.renovationFund < 0) houseData.renovationFund = 0;
                
                // Add as completed renovation
                houseData.propertyValue = Math.round(houseData.propertyValue * 1.05); // 5% value increase
                updateDashboard();
                alert(`Added ${project}. Property value increased!`);
            }
        }

        function generateReport() {
            const report = `
HOUSE EMPIRE PROGRESS REPORT
Generated: ${new Date().toLocaleString()}

PROPERTY SUMMARY:
Monthly Cashflow: $${houseData.monthlyCashflow}
Property Value: $${houseData.propertyValue}
Renovation Fund: $${houseData.renovationFund} (${Math.round((houseData.renovationFund / houseData.renovationTarget) * 100)}% of target)
Occupancy Rate: ${Math.round((houseData.rooms.filter(r => r.status === "occupied" || r.status === "premium").length / houseData.rooms.length) * 100)}%

ROOM PORTFOLIO:
${houseData.rooms.map(r => `‚Ä¢ ${r.name}: $${r.rent} (${r.status})`).join('\n')}

MONTHLY EXPENSES:
${houseData.expenses.map(e => `‚Ä¢ ${e.name}: $${e.amount}`).join('\n')}

NEXT RECOMMENDED ACTIONS:
1. Increase rents on premium rooms
2. Complete Phase 1 renovations
3. Add value-added services
            `;
            
            alert(report);
            console.log(report);
        }

        function exportData() {
            const dataStr = JSON.stringify(houseData, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
            
            const exportFileDefaultName = 'house-empire-data.json';
            
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', exportFileDefaultName);
            linkElement.click();
        }

        // Initialize dashboard
        document.addEventListener('DOMContentLoaded', loadData);
    </script>
</body>
</html>